<!-- HTML header for doxygen 1.9.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Dynamic Script Engine Plugin for Touch Portal: Color Picker Example</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init();
    DoxygenAwesomeParagraphLink.init();
    DoxygenAwesomeInteractiveToc.init();
    // hide the Documentation header and sidebar link since it's redundant when on the docs site already.
    $(window).on('load', () => {
      function removeElements() {
        if (!$("a[class='index.html:autotoc_md11']").length)
          setTimeout(removeElements, 10);
        var el = document.getElementById("autotoc_md11"),
          els = document.getElementsByClassName("index.html:autotoc_md11");
        if (el)
          el.parentNode.style.display = 'none';
        if (els.length)
          els[0].parentElement.parentElement.parentElement.style.display= 'none';
      };
      removeElements();
    });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/mpaperno/DSEP4TP" class="github-corner" title="View source on GitHub" target="_blank">
    <svg viewBox="0 0 250 250" width="40" height="40" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z" fill="url(#gradient)"></path>
    <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
    <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
    <linearGradient id="gradient" x1="0.5" x2="0.5" y1="0" y2="1">
        <stop class="first-stop" offset="0%"></stop>
        <stop class="last-stop" offset="100%"></stop>
    </linearGradient>
    </svg>
</a>
<style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Logo.png" title="Dynamic Script Engine Plugin for Touch Portal - A complete, standalone, multi-threaded JavaScript environment available as a plugin for use with Touch Portal macro launcher software."/></td>
  <td id="projectalign">
   <div id="projectname"><!-- Dynamic Script Engine Plugin for Touch Portal --><span id="projectnumber">&#160;v1.0.0.2-beta2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('example_color_picker.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title"><a class="el" href="class_color.html" title="Provides functions for working with color.">Color</a> Picker Example </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="anchor" id="md_D__Devel_TouchPortal_DynamicValues_DynamicValuesTPP_resources_examples_ColorPicker_README"></a>A script and page example of an interface for choosing a color.</p>
<div class="hide-on-site"></div><div class="hide-on-site"><b>See the <a href="https://dse.tpp.max.paperno.us/example_color_picker.html" target="_blank">published documentation</a> for a properly formatted version of this README.</b> </div><p >This example demonstrate some uses of the <a class="el" href="class_color.html" title="Provides functions for working with color.">Color</a> library to create a basic "color picker" type interface (scroll down for page screenshot). It also uses the <a class="el" href="example_clipboard.html">Clipboard example</a> module for interacting with the system clipboard (copying colors to and from).</p>
<p >The script itself is mostly just an "interface" to the various color manipulation features available with a <a class="el" href="class_color.html" title="Provides functions for working with color.">Color</a> object. It stores an instance of a <a class="el" href="class_color.html" title="Provides functions for working with color.">Color</a> value, which is the "current color," and all operations are performed on this color, after which it is usually sent back to Touch Portal as a new color value to be displayed somewhere (like the central "swatch" in the example page).</p>
<p >The example page uses 8 global Touch Portal Values as inputs to control various aspects of the color (color channel values, opacity, saturation, etc). Each Value is controlled by a Slider and also the corresponding up/down buttons. The central "color swatch" button is where the input value changes are detected and sent to the loaded script (which then returns the new resulting color to use as the swatch background color).</p>
<p >Additionally there are buttons to invoke clipboard functions to copy the current color to clipboard in various formats, and another button to set the current color <em>from</em> a value on the clipboard (it has to be in one of the recognized formats... see <code>setColor()</code> notes in the code below).</p>
<p >The up/down buttons for each input value are there because Touch Portal Sliders only have a resolution of 0 through 100, whereas most of the actual color values can be in a range of 0 through 255 (or 0-360 for Hue). So, the buttons provide a way to "fine tune" the value to account for the missing resolution of the sliders.</p>
<dl class="section note"><dt>Note</dt><dd>Assets for this example, including the code and page shown below, can be found in the project's repository at<br  />
 <a href="https://github.com/mpaperno/DSEP4TP/tree/main/resources/examples/ColorPicker/">https://github.com/mpaperno/DSEP4TP/tree/main/resources/examples/ColorPicker/</a></dd></dl>
<h2><a class="anchor" id="autotoc_md64"></a>
Example page using this script</h2>
<p ><a href="example_color_picker_screenshot.jpg" target="image" title="Click for full version in new window."><img src="example_color_picker_screenshot.jpg" alt="" class="inline"/> </a></p>
<h2><a class="anchor" id="autotoc_md65"></a>
Initial page setup</h2>
<ol type="1">
<li>Download the <a href="https://github.com/mpaperno/DSEP4TP/tree/main/resources/examples/ColorPicker/DSE_Color_Picker_v2.tpz" target="_blank">DSE_Color_Picker_v2 page</a>, <a href="https://github.com/mpaperno/DSEP4TP/tree/main/resources/examples/ColorPicker/color_picker.mjs" target="_blank">color_picker.mjs</a>, and <a href="https://github.com/mpaperno/DSEP4TP/tree/main/resources/examples/Clipboard/clipboard.mjs" target="_blank">clipboard.mjs</a> script files.</li>
<li>Place the two script files anywhere you want in your file system, as long as they're both in the same folder. I recommend starting a new folder for scripts somewhere like in your <em>Documents</em>.</li>
<li>Import the page into Touch Portal<ul>
<li>If you have <em>not</em> imported any previous version of this page, make sure the "Values" option is selected.</li>
<li>On the other hand, if you're updating a previous version of this page, make sure the "Values" option is <em>not</em> selected.</li>
</ul>
</li>
<li>Open/go to the page in the Touch Portal desktop application. In place of the central color swatch in the screenshot above will be an "INITIALIZE" button.<ul>
<li>Edit that button's <em>On Pressed</em> action and make sure the path to <code>color_picker.mjs</code> matches where you placed the script on your computer.<ul>
<li>You can either type or paste in the script location (path) or use the <code>...</code> button to find and select the script with a standard file dialog.</li>
</ul>
</li>
<li>You could also now remove the button with the "INITIAL ONE-TIME SETUP" instructions text if you want (it serves no other purpose).</li>
</ul>
</li>
<li>Create a new button somewhere (eg. on your (main) page) that opens this page on your Touch Portal Android/iOS device.</li>
<li>Navigate to the new page on your device, and then press the INITIALIZE button.<ul>
<li>This only needs to be done once when you first import the page. After that everything should be re-created automatically next time you start Touch Portal (or restart this plugin).</li>
</ul>
</li>
<li>The "INITIALIZE" button should turn into a white color swatch and the page is ready for use.</li>
<li>Optional: If you make any changes to the included script file, you need to use the "Reset Module" button to clear out the old script version before your changes will be detected.<ul>
<li>This button also needs to have the location of <code>color_picker.mjs</code> properly set up, just like in the "INITILIZE" button.</li>
</ul>
</li>
</ol>
<p ><b>Note</b><br  />
 You can set a default location (directory) for script files in the plugin's Settings (in <em>Touch Portal -&gt; Settings -&gt; Plug-ins</em>). That way you could use only relative paths to script files in the plugin's actions (which is how the page comes set up by default).</p>
<h2><a class="anchor" id="autotoc_md66"></a>
Color Picker script</h2>
<div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">// Import clipboard functions from Clipboard example module.  The import path assumes both examples are in the same folder.</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="keyword">import</span> { valueToClipboard, clipboardToValue } from <span class="stringliteral">&quot;clipboard.mjs&quot;</span>;</div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span> </div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">// This script creates Touch Portal States dynamically as needed.</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">// This variable sets the title under which all the created States are grouped.</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">// The group will appear as a child of the Dynamic Script Engine main plugin grouping in TP menus.</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span>export var STATES_GROUP_NAME = <span class="stringliteral">&quot;Color Picker&quot;</span>;</div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span> </div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">// Template for formatted color value. .NET String.Format() style.</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment">// Template values are: 0 = red; 1 = blue; 2 = green; 3 = alpha; 4 = hue; 5 = saturation; 6 = value; 7 = lightness</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span>export var FORMATTED_COLOR_TEMPLATE = <span class="stringliteral">&quot;R: {0:000}\nG: {1:000}\nB: {2:000}\nA: {3:000%}&quot;</span>;</div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span> </div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment">// Returns the current Color object, on which various methods can be invoked directly.</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment">// See documentation at: https://dse.tpp.max.paperno.us/class_color.html</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span>export <span class="keyword">function</span> color()</div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span>{</div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span>  <span class="keywordflow">return</span> _data.color;</div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span>}</div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span> </div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="comment">// Returns current color in &quot;Touch Portal&quot; format of #AARRGGBB format,</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="comment">// suitable for use in an &quot;Change visuals by plug-in state&quot; action.</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span>export <span class="keyword">function</span> <a class="code hl_function" href="class_color.html#af7a57ec62f370d92e749c92e43e62f68">tpcolor</a>()</div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span>{</div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span>  <span class="keywordflow">return</span> color().tpcolor();</div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span>}</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span> </div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="comment">// Sets the current color to `color` which can be:</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="comment">// - An hex string in &quot;#RRGGBB[AA]&quot; format, with or w/out the leading &quot;#&quot;;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="comment">// - A color name from CSS specification, eg &quot;red&quot;, &quot;darkblue&quot;, etc.;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="comment">// - Any other valid CSS-style color specifier string, eg. &quot;rgba(255, 0, 0, .5)&quot; or &quot;hsl(0, 100%, 50%)&quot; or &quot;hsva(0, 100%, 50%, .5)&quot;, etc.;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="comment">// - An object representing rgb[a]/hsl[a]/hsv[a] values, eg. `{ r: 255, g: 0, b: 0 }` or  `{ h: 0, s: 1, l: .5, a: .75 }` or `{ h: 0, s: 100, v: 100 }`;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="comment">// - Another Color object instance.</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>export <span class="keyword">function</span> setColor(color)</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>{</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>  _data.color = <span class="keyword">new</span> <a class="code hl_class" href="class_color.html">Color</a>(color);</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>  update();</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="class_color.html#af7a57ec62f370d92e749c92e43e62f68">tpcolor</a>();</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>}</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span> </div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="comment">// Sets the current color from an &quot;#AARRGGBB&quot; format string (this format is used by Touch Portal</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="comment">// for button background and text colors in &quot;Change visuals by plug-in state&quot; actions).</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>export <span class="keyword">function</span> setColorArgb(color)</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>{</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>  <span class="keyword">const</span> rgba = color.length === 9 ? color.replace(/^#([0-9a-z]{2})([0-9a-z]{6})$/i, <span class="stringliteral">&#39;#$2$1&#39;</span>) : color;</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>  <span class="keyword">const</span> newColor = <span class="keyword">new</span> <a class="code hl_class" href="class_color.html">Color</a>(rgba);</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>  <span class="keywordflow">if</span> (newColor.isValid())</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>    <span class="keywordflow">return</span> setColor(newColor);</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>  console.error(`<span class="stringliteral">&#39;${color}&#39;</span> is not a valid color.`);</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="class_color.html#af7a57ec62f370d92e749c92e43e62f68">tpcolor</a>();</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>}</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span> </div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="comment">// Returns the current text Color object.</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>export <span class="keyword">function</span> textColor()</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>{</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>  <span class="keywordflow">return</span> _data.textColor;</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>}</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span> </div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="comment">// Sets the current text color and updates the &quot;Text Color&quot; State with the color as an &quot;#RRGGBB&quot; format string.</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span><span class="comment">// See `setColor()` for allowed format specifics.</span></div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>export <span class="keyword">function</span> setTextColor(color)</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>{</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>  _data.textColor = <span class="keyword">new</span> <a class="code hl_class" href="class_color.html">Color</a>(color);</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>  sendTextColor();</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>}</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span> </div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span><span class="comment">// Color channel/component setting functions.</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span> </div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span><span class="comment">// Set the red component of the current color to a percentage value (0 - 100) and returns the new color as an #AARRGGBB string.</span></div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>export <span class="keyword">function</span> setRed(percent)</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>{</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>  color()._r = percentToShort(percent);</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>  update();</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="class_color.html#af7a57ec62f370d92e749c92e43e62f68">tpcolor</a>();</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>}</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span> </div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span><span class="comment">// Set the green component of the current color to a percentage value (0 - 100) and returns the new color as an #AARRGGBB string.</span></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>export <span class="keyword">function</span> setGreen(percent)</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>{</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>  color()._g = percentToShort(percent);</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>  update();</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="class_color.html#af7a57ec62f370d92e749c92e43e62f68">tpcolor</a>();</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>}</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span> </div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span><span class="comment">// Set the blue component of the current color to a percentage value (0 - 100) and returns the new color as an #AARRGGBB string.</span></div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>export <span class="keyword">function</span> setBlue(percent)</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>{</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>  color()._b = percentToShort(percent);</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>  update();</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="class_color.html#af7a57ec62f370d92e749c92e43e62f68">tpcolor</a>();</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>}</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span> </div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span><span class="comment">// Set the alpha (transparency) component of the current color to a percentage value (0 - 100) and returns the new color as an #AARRGGBB string.</span></div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>export <span class="keyword">function</span> setAlpha(alpha)</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>{</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>  color().setAlpha(alpha * 0.01);</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>  update();</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="class_color.html#af7a57ec62f370d92e749c92e43e62f68">tpcolor</a>();</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>}</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span> </div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span><span class="comment">// Set the hue component of the current color to a percentage value (0 - 100) and returns the new color as an #AARRGGBB string.</span></div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>export <span class="keyword">function</span> setHue(percent)</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>{</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>  var hsl = color().toHsl();</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>  hsl.h = percentToDegrees(percent);</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>  <span class="keywordflow">return</span> setColor(hsl);</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>}</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span> </div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span><span class="comment">// Set the saturation component of the current color to a percentage value (0 - 100) and returns the new color as an #AARRGGBB string.</span></div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>export <span class="keyword">function</span> setSaturation(percent)</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>{</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>  var hsl = color().toHsl();</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>  <span class="keywordflow">if</span> (percent === 1)</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>    percent += .01;</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>  hsl.s = percent;</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>  <span class="keywordflow">return</span> setColor(hsl);</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>}</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span> </div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span><span class="comment">// Set the lightness component of the current color to a percentage value (0 - 100) and returns the new color as an #AARRGGBB string.</span></div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>export <span class="keyword">function</span> setLightness(percent)</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>{</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>  var hsl = color().toHsl();</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>  <span class="keywordflow">if</span> (percent === 1)</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>    percent += .01;</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>  hsl.l = percent;</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>  <span class="keywordflow">return</span> setColor(hsl);</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>}</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span> </div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span><span class="comment">// Set the value component of the current color to a percentage value (0 - 100) and returns the new color as an #AARRGGBB string.</span></div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>export <span class="keyword">function</span> setValue(percent)</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>{</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>  var hsv = color().toHsv();</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>  <span class="keywordflow">if</span> (percent === 1)</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>    percent += .01;</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>  hsv.v = percent;</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>  <span class="keywordflow">return</span> setColor(hsv);</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>}</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span> </div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span><span class="comment">// Adjustment (step increment/decrement) functions.</span></div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span> </div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span><span class="comment">// Changes the red component of the current color by a percentage value (0 - 100) and returns the new color as an #AARRGGBB string.</span></div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>export <span class="keyword">function</span> adjustRed(amount)</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>{</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>  <span class="keywordflow">return</span> setRed(color()._r + percentToShort(amount));</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>}</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span> </div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span><span class="comment">// Changes the green component of the current color by a percentage value (0 - 100) and returns the new color as an #AARRGGBB string.</span></div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>export <span class="keyword">function</span> adjustGreen(amount)</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>{</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>  <span class="keywordflow">return</span> setGreen(color()._g + percentToShort(amount));</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>}</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span> </div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span><span class="comment">// Changes the blue component of the current color by a percentage value (0 - 100) and returns the new color as an #AARRGGBB string.</span></div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>export <span class="keyword">function</span> adjustBlue(amount)</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>{</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>  <span class="keywordflow">return</span> setBlue(color()._b + percentToShort(amount));</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>}</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span> </div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span><span class="comment">// Changes the alhpa component of the current color by a percentage value (0 - 100) and returns the new color as an #AARRGGBB string.</span></div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>export <span class="keyword">function</span> adjustAlpha(amount)</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>{</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>  <span class="keywordflow">return</span> setAlpha(color().alpha() + amount * 0.01);</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>}</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span> </div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span><span class="comment">// Changes the hue component of the current color by a percentage value (0 - 100) and returns the new color as an #AARRGGBB string.</span></div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>export <span class="keyword">function</span> adjustHue(amount)</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>{</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>  <span class="keywordflow">return</span> setHue(color().toHsl().h + percentToDegrees(amount));</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>}</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span> </div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span><span class="comment">// Changes the saturation component of the current color by a percentage value (0 - 100) and returns the new color as an #AARRGGBB string.</span></div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>export <span class="keyword">function</span> adjustSaturation(amount)</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>{</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>  <span class="keywordflow">return</span> setSaturation(color().toHsl().s + amount);</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>}</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span> </div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span><span class="comment">// Changes the lightness component of the current color by a percentage value (0 - 100) and returns the new color as an #AARRGGBB string.</span></div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>export <span class="keyword">function</span> adjustLightness(amount)</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>{</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>  <span class="keywordflow">return</span> setLightness(color().toHsl().l + amount);</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>}</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span> </div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span><span class="comment">// Changes the value component of the current color by a percentage value (0 - 100) and returns the new color as an #AARRGGBB string.</span></div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>export <span class="keyword">function</span> adjustValue(amount)</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>{</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>  <span class="keywordflow">return</span> setValue(color().toHsv().v + amount);</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>}</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span> </div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span><span class="comment">// Color complement/series array generators.</span></div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span> </div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span><span class="comment">// Generates a color complementary to the current color.</span></div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span><span class="comment">// Updates/creates 1 State based on current instance name + &quot;_complement&quot;.</span></div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>export <span class="keyword">function</span> <a class="code hl_function" href="class_color.html#a87d6ad92217614866d946757fba2d8f3">complement</a>()</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>{</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>  sendColorsArray([color().<a class="code hl_function" href="class_color.html#a87d6ad92217614866d946757fba2d8f3">complement</a>()], <span class="stringliteral">&quot;complement&quot;</span>);</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>}</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span> </div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span><span class="comment">// Generates 2 colors which are split-complementary to the current color.</span></div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span><span class="comment">// Updates/creates 2 States based on current instance name + &quot;_splitcomp_1&quot; and  + &quot;_splitcomp_2&quot;.</span></div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>export <span class="keyword">function</span> splitcomplement()</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>{</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>  sendColorsArray(color().splitcomplement().slice(1), <span class="stringliteral">&quot;splitcomp&quot;</span>);</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>}</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span> </div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span><span class="comment">// Enables or disables the automatic updating of complement, split complement, and last selected series based on the current color.</span></div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>export <span class="keyword">function</span> autoUpdateSeries(enable = <span class="keyword">true</span>)</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>{</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>  <span class="keywordflow">if</span> (_data.autoUpdate === enable)</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span> </div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>  _data.autoUpdate = enable;</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>  updateSeries();</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span> </div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>  <span class="comment">// Send a State update with the new value of the autoUpdateSeries setting (eg. to use as button visual change trigger).</span></div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>  <span class="comment">// Create the State first if necessary.</span></div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>  <span class="keywordflow">if</span> (!_data.autoUpdateEnabledState) {</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>    _data.autoUpdateEnabledState = DSE.instanceStateId() + <span class="stringliteral">&#39;_autoUpdateSeries&#39;</span>;</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>    <span class="keyword">const</span> stateDescript = DSE.INSTANCE_NAME + <span class="stringliteral">&quot; Auto Update Complement/Series&quot;</span>;</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>    <span class="comment">// the default should be 0, but due to a &quot;bug&quot; in TP &lt;= v3.1 we need to force it to a blank value first.</span></div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>    <a class="code hl_namespace" href="namespace_t_p.html">TP</a>.stateCreate(_data.autoUpdateEnabledState, STATES_GROUP_NAME, stateDescript, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>  }</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>  <a class="code hl_namespace" href="namespace_t_p.html">TP</a>.stateUpdateById(_data.autoUpdateEnabledState, _data.autoUpdate ? <span class="stringliteral">&quot;1&quot;</span> : <span class="stringliteral">&quot;0&quot;</span>);</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>}</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span> </div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span><span class="comment">// Toggles the automatic series updates. Convenience for `autoUpdateSeries()` based on current setting.</span></div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>export <span class="keyword">function</span> autoUpdateSeriesToggle()</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>{</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>  autoUpdateSeries(!_data.autoUpdate);</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>}</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span> </div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span><span class="comment">// This function clears the current color series (polyad, analogous, mono),</span></div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span><span class="comment">// sending an array of `n` transparent colors instead. If `n` is -1 (default) then the count from the last</span></div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span><span class="comment">// requested series is used.  If `n` is 0, then no transparent colors are sent (the last series color state values stay intact).</span></div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span><span class="comment">// Can be used to simply clear any current series colors or to keep automatic updates of complement/split comp but w/out series updates.</span></div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>export <span class="keyword">function</span> clearCurrentSeries(n = -1)</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>{</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>  _data.lastSeries.t = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>  var colors = [];</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>  <span class="keywordflow">if</span> (n &lt; 0)</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>    n = _data.lastSeries.n;</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>  <span class="keywordflow">for</span> (let i=0; i &lt; n; ++i)</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>    colors.push(<span class="keyword">new</span> <a class="code hl_class" href="class_color.html">Color</a>(<span class="stringliteral">&#39;#00000000&#39;</span>));</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>  sendColorsArray(colors);</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>}</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span> </div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span><span class="comment">// Generates up to `n` number of colors harmonious with the current color. Updates/creates States based on current instance name and numeric suffix.</span></div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>export <span class="keyword">function</span> <a class="code hl_function" href="class_color.html#adfb086b470804a4f7dc911d2dd148cab">polyad</a>(n)</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>{</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>  _data.lastSeries.t = <span class="stringliteral">&quot;polyad&quot;</span>;</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>  _data.lastSeries.n = n;</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>  sendColorsArray(color().<a class="code hl_function" href="class_color.html#adfb086b470804a4f7dc911d2dd148cab">polyad</a>(n+1).slice(1));</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>}</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span> </div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span><span class="comment">// Generates up to `n` number of colors analogous to the current color. Updates/creates States based on current instance name and numeric suffix.</span></div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>export <span class="keyword">function</span> analogous(n, slices = 30)</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>{</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>  _data.lastSeries.t = <span class="stringliteral">&quot;analogous&quot;</span>;</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>  _data.lastSeries.n = n;</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>  _data.lastSeries.s = slices;</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>  sendColorsArray(color().analogous(n+1, slices).slice(1));</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>}</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span> </div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span><span class="comment">// Generates up to `n` number of monochromatic colors based on the current color. Updates/creates States based on current instance name and numeric suffix.</span></div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>export <span class="keyword">function</span> monochromatic(n)</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>{</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>  _data.lastSeries.t = <span class="stringliteral">&quot;monochromatic&quot;</span>;</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>  _data.lastSeries.n = n;</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>  sendColorsArray(color().monochromatic(n+1).slice(1));</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>}</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span> </div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span><span class="comment">// Clipboard functions. Uses Clipboard example module, imported at top.</span></div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span><span class="comment">// NOTE: Linux requires `xclip` utility installed.</span></div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span> </div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span><span class="comment">// Tries to set a new color from a clipboard value. Accepted formats are same as described in `setColor()` above.</span></div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span><span class="comment">// In case the clipboard does not hold a valid color value, this function will log a warning message and return</span></div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span><span class="comment">// the current color instead (no changes to current color will be made).</span></div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>export <span class="keyword">function</span> fromClipboard()</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>{</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>  <span class="keyword">const</span> val = clipboardToValue();</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>  <span class="comment">// console.log(&quot;Clipboard value:&quot;, val);</span></div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>  <span class="keyword">const</span> color = <span class="keyword">new</span> <a class="code hl_class" href="class_color.html">Color</a>(val);</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>  <span class="keywordflow">if</span> (color.isValid())</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>    <span class="keywordflow">return</span> setColor(color);</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>  console.error(<span class="stringliteral">&quot;Clipboard contents were not a valid color.&quot;</span>);</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="class_color.html#af7a57ec62f370d92e749c92e43e62f68">tpcolor</a>();</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>}</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span> </div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span><span class="comment">// Copy current color in &quot;#RRGGBBAA&quot; format to the clipboard.</span></div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>export <span class="keyword">function</span> copyRgba()</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>{</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>  valueToClipboard(color().rgba());</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>}</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span> </div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span><span class="comment">// Copy current color in &quot;#RRGGBB&quot; format to the clipboard.</span></div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>export <span class="keyword">function</span> copyHex()</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>{</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>  valueToClipboard(color().hex());</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>}</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span> </div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span><span class="comment">// Copy current color in &quot;#AARRGGBB&quot; format to the clipboard.</span></div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>export <span class="keyword">function</span> copyArgb()</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>{</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>  valueToClipboard(color().argb());</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>}</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span> </div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span><span class="comment">// Copy current color in &quot;rgb(r, g, b [, a])&quot; format to the clipboard.</span></div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span><span class="comment">// The alpha component will be included if it is not fully opaque (&lt; 1.0).</span></div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span><span class="comment">// eg: rgb(214, 173, 46) or rgba(214, 173, 46, 0.61)</span></div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>export <span class="keyword">function</span> copyRgb()</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>{</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>  valueToClipboard(color().rgb());</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>}</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span> </div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span><span class="comment">// Copy current color in &quot;hsv[a](h, s%, v% [, a])&quot; format to the clipboard.</span></div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span><span class="comment">// The alpha component will be included if it is not fully opaque (&lt; 1.0).</span></div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span><span class="comment">// eg: hsv(45, 79%, 84%) or hsva(45, 79%, 84%, 0.61)</span></div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>export <span class="keyword">function</span> copyHsv()</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>{</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>  valueToClipboard(color().hsv());</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>}</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span> </div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span><span class="comment">// Copy current color in &quot;hsl[a](h, s%, v% [, a])&quot; format to the clipboard.</span></div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span><span class="comment">// The alpha component will be included if it is not fully opaque (&lt; 1.0).</span></div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span><span class="comment">// eg: hsl(45, 67%, 51%) or hsla(45, 67%, 51%, 0.61)</span></div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>export <span class="keyword">function</span> copyHsl()</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>{</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>  valueToClipboard(color().hsl());</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>}</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span> </div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span><span class="comment">// Text color functions</span></div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span> </div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span><span class="comment">// Set the hue component of the current text color to a percentage value (0 - 100) and returns the new color as an #AARRGGBB string.</span></div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span><span class="comment">// If `percent` is zero, the text color is placed into &quot;auto&quot; mode which will show either light or dark text based on current main</span></div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span><span class="comment">// color value (dark text on light color and vice versa).</span></div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>export <span class="keyword">function</span> setTextHue(percent)</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>{</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>  _data.textColorAuto = !percent;</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>  <span class="keywordflow">if</span> (_data.textColorAuto) {</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>    updateTextColor();</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>  }</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span> </div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>  <span class="comment">// need to reset pure white or black colors to some primary color before shifting hue.</span></div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="class_color.html">Color</a>.equals(COLOR_WHITE, textColor()) || <a class="code hl_class" href="class_color.html">Color</a>.equals(COLOR_BLACK, textColor()))</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>    _data.textColor = <span class="keyword">new</span> <a class="code hl_class" href="class_color.html">Color</a>({ r: 255, g: 0, b: 0 });</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>  var hsl = textColor().toHsl();</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>  hsl.h = percentToDegrees(percent);</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>  setTextColor(hsl);</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>}</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span> </div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span><span class="keyword">function</span> updateTextColor()</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>{</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>  <span class="keywordflow">if</span> (!_data.textColorAuto)</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>  <span class="keywordflow">if</span> (color().isLight()) {</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>    <span class="keywordflow">if</span> (!<a class="code hl_class" href="class_color.html">Color</a>.equals(COLOR_BLACK, textColor()))</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>      setTextColor(COLOR_BLACK.clone());</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>  }</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>    <span class="keywordflow">if</span> (!<a class="code hl_class" href="class_color.html">Color</a>.equals(COLOR_WHITE, textColor()))</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>      setTextColor(COLOR_WHITE.clone());</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>  }</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>}</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span> </div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span><span class="keyword">function</span> sendTextColor()</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>{</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>  <span class="comment">// Send a State update with the new text color value. Create the State first if necessary.</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>  <span class="keywordflow">if</span> (!_data.textColorState) {</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>    _data.textColorState = DSE.instanceStateId() + <span class="stringliteral">&#39;_textColor&#39;</span>;</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>    <span class="keyword">const</span> stateDescript = DSE.INSTANCE_NAME + <span class="stringliteral">&quot; Text Color&quot;</span>;</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>    <span class="comment">//                               ID, Category,          Description,   Default</span></div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>    <a class="code hl_namespace" href="namespace_t_p.html">TP</a>.stateCreate(_data.textColorState, STATES_GROUP_NAME, stateDescript, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>  }</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>  <span class="comment">// Send the actual state value update.</span></div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>  <a class="code hl_namespace" href="namespace_t_p.html">TP</a>.stateUpdateById(_data.textColorState, textColor().hex());</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>}</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span> </div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span><span class="comment">// Private/internal utility functions</span></div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span> </div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span><span class="comment">// Internal function used to perform automatic updates of complement/split comp./series colors when current color changes.</span></div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span><span class="keyword">function</span> updateSeries()</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>{</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>  <span class="keywordflow">if</span> (!_data.autoUpdate)</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>  <a class="code hl_function" href="class_color.html#a87d6ad92217614866d946757fba2d8f3">complement</a>();</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>  splitcomplement();</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>  <span class="keywordflow">switch</span>(_data.lastSeries.t) {</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>    <span class="keywordflow">case</span> <span class="stringliteral">&#39;polyad&#39;</span>:</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>      <a class="code hl_function" href="class_color.html#adfb086b470804a4f7dc911d2dd148cab">polyad</a>(_data.lastSeries.n);</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>    <span class="keywordflow">case</span> <span class="stringliteral">&#39;analogous&#39;</span>:</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>      analogous(_data.lastSeries.n, _data.lastSeries.s);</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>    <span class="keywordflow">case</span> <span class="stringliteral">&#39;monochromatic&#39;</span>:</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>      monochromatic(_data.lastSeries.n);</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>  }</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>}</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span> </div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span><span class="comment">// This internal function is used by the array generator functions above to send results back to Touch Portal as States.</span></div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span><span class="comment">// The states are created dynamically as needed (in case they do not exist yet), and then updated to the current value from the array.</span></div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span><span class="comment">// The state IDs and names are based on the current Dynamic Script Engine instance which is running this module.</span></div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span><span class="keyword">function</span> sendColorsArray(arry, stateNamePrefix = <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>{</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>  <span class="keyword">const</span> len = arry.length;</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>  <span class="keywordflow">for</span> (let i=0; i &lt; len; ++i) {</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>    let stateId = DSE.instanceStateId() + <span class="charliteral">&#39;_&#39;</span>;</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>    <span class="keywordflow">if</span> (stateNamePrefix)</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>      stateId += stateNamePrefix;</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>      stateId += <span class="stringliteral">&quot;series&quot;</span>;</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>    <span class="keywordflow">if</span> (len &gt; 1)</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>      stateId += `_${i+1}`;</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>    <span class="comment">// Create new state if needed</span></div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>    <span class="keywordflow">if</span> (_data.createdStates.indexOf(stateId) &lt; 0) {</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>      let stateDescript = DSE.INSTANCE_NAME + <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>      <span class="keywordflow">if</span> (stateNamePrefix)</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>        stateDescript += stateNamePrefix;</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>        stateDescript += <span class="stringliteral">&quot;series color&quot;</span>;</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>      <span class="keywordflow">if</span> (len &gt; 1)</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>        stateDescript += ` ${i+1}`;</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>      <span class="comment">//             ID,      Parent Category,   Description,   Default value</span></div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>      <a class="code hl_namespace" href="namespace_t_p.html">TP</a>.stateCreate(stateId, STATES_GROUP_NAME, stateDescript, <span class="stringliteral">&quot;#00000000&quot;</span>);</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>      _data.createdStates.push(stateId);</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>    }</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span> </div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>    <a class="code hl_namespace" href="namespace_t_p.html">TP</a>.stateUpdateById(stateId, arry[i].<a class="code hl_function" href="class_color.html#af7a57ec62f370d92e749c92e43e62f68">tpcolor</a>());</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>  }</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>}</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span> </div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span><span class="keyword">function</span> update()</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>{</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>  updateTextColor();</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>  updateSeries();</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span> </div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>  <span class="comment">// Send a State update with the new color as formatted text. Create the State first if necessary.</span></div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>  <span class="keywordflow">if</span> (!_data.formattedColorState) {</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>    _data.formattedColorState = DSE.instanceStateId() + <span class="stringliteral">&#39;_formatted&#39;</span>;</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>    <span class="keyword">const</span> stateDescript = DSE.INSTANCE_NAME + <span class="stringliteral">&quot; Formatted Color&quot;</span>;</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>    <a class="code hl_namespace" href="namespace_t_p.html">TP</a>.stateCreate(_data.formattedColorState, STATES_GROUP_NAME, stateDescript, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>  }</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>  <span class="keyword">const</span> rgb = color().toRgb();</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>  <span class="keyword">const</span> hsv = color().toHsv();</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>  <span class="keyword">const</span> value = <a class="code hl_function" href="class_global.html#acd5e884df6b19a0c00b5747908e20d5d">Format</a>(FORMATTED_COLOR_TEMPLATE, rgb.r, rgb.g, rgb.b, rgb.a, hsv.h, hsv.s, hsv.v, color().toHsl().l);</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>  <a class="code hl_namespace" href="namespace_t_p.html">TP</a>.stateUpdateById(_data.formattedColorState, value);</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>}</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span> </div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span><span class="keyword">const</span> COLOR_BLACK = <span class="keyword">new</span> <a class="code hl_class" href="class_color.html">Color</a>({ r: 0, g: 0, b: 0 });</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span><span class="keyword">const</span> COLOR_WHITE = <span class="keyword">new</span> <a class="code hl_class" href="class_color.html">Color</a>({ r: 255, g: 255, b: 255 });</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span> </div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span><span class="comment">// Internal data storage.</span></div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>var _data = _data ||</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>{</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>  color: COLOR_WHITE.clone(),         <span class="comment">// the current color</span></div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>  textColor: COLOR_WHITE.clone(),     <span class="comment">// the current text color (eg. to show on color swatch)</span></div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>  textColorAuto: <span class="keyword">true</span>,                <span class="comment">// whether to automatically set the text color based on overall darkness of current main color</span></div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>  autoUpdate: <span class="keyword">false</span>,                  <span class="comment">// enable/disable automatic update of complement/split comp./last series when current color changes</span></div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>  lastSeries: { t: <span class="stringliteral">&quot;&quot;</span>, n: 0, s: 0 },  <span class="comment">// track which series type was last selected (if any)</span></div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>  createdStates: [],                  <span class="comment">// keep track of created state IDs so we do not re-create them each time</span></div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>  formattedColorState: <span class="stringliteral">&quot;&quot;</span>,            <span class="comment">// ID of created formatted color state, blank if not created yet</span></div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>  textColorState: <span class="stringliteral">&quot;&quot;</span>,                 <span class="comment">// ID of created text color state, blank if not created yet</span></div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>  autoUpdateEnabledState: <span class="stringliteral">&quot;&quot;</span>,         <span class="comment">// ID of created series auto-update status state, blank if not created yet</span></div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>};</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span> </div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span><span class="comment">// Conversion utilities</span></div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span><span class="keyword">function</span> percentToShort(value) { <span class="keywordflow">return</span> <a class="code hl_function" href="class_math.html#a3bf8d748d3c4af419876eebedfdcc52b">roundTo</a>(value.clamp(0, 100) * 2.55, 0) }</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span><span class="keyword">function</span> percentToDegrees(value) { <span class="keywordflow">return</span> <a class="code hl_function" href="class_math.html#a3bf8d748d3c4af419876eebedfdcc52b">roundTo</a>(value.clamp(0, 100) * 3.6, 0) }</div>
<div class="ttc" id="aclass_color_html"><div class="ttname"><a href="class_color.html">Color</a></div><div class="ttdoc">Provides functions for working with color.</div></div>
<div class="ttc" id="aclass_color_html_a87d6ad92217614866d946757fba2d8f3"><div class="ttname"><a href="class_color.html#a87d6ad92217614866d946757fba2d8f3">Color::complement</a></div><div class="ttdeci">Color complement(Color color)</div><div class="ttdoc">Returns a new Color which is complimentary to color.</div></div>
<div class="ttc" id="aclass_color_html_adfb086b470804a4f7dc911d2dd148cab"><div class="ttname"><a href="class_color.html#adfb086b470804a4f7dc911d2dd148cab">Color::polyad</a></div><div class="ttdeci">Color polyad(number n)</div><div class="ttdoc">Returns an array of up to n colors harmonious with this color.</div></div>
<div class="ttc" id="aclass_color_html_af7a57ec62f370d92e749c92e43e62f68"><div class="ttname"><a href="class_color.html#af7a57ec62f370d92e749c92e43e62f68">Color::tpcolor</a></div><div class="ttdeci">string tpcolor()</div><div class="ttdoc">Returns color formatted in #AARRGGBB format (this is suitable for use with Touch Portal's &quot;Set Text/B...</div><div class="ttdef"><b>Definition:</b> color.js:474</div></div>
<div class="ttc" id="aclass_global_html_acd5e884df6b19a0c00b5747908e20d5d"><div class="ttname"><a href="class_global.html#acd5e884df6b19a0c00b5747908e20d5d">Global::Format</a></div><div class="ttdeci">string Format(format)</div><div class="ttdoc">Equivalent to the String.format() extension method.</div></div>
<div class="ttc" id="aclass_math_html_a3bf8d748d3c4af419876eebedfdcc52b"><div class="ttname"><a href="class_math.html#a3bf8d748d3c4af419876eebedfdcc52b">Math::roundTo</a></div><div class="ttdeci">number roundTo(number value, number precision)</div><div class="ttdoc">Round value to precision decimal places.</div></div>
<div class="ttc" id="anamespace_t_p_html"><div class="ttname"><a href="namespace_t_p.html">TP</a></div><div class="ttdoc">Functions for interacting with Touch Portal directly, such as updating state values or sending notifi...</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.4-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="plugin_examples.html">Examples</a></li>
    <li class="footer">Generated for Dynamic Script Engine Plugin for Touch Portal &#160;v1.0.0.2-beta2 by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
